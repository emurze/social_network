<script defer>
    const post_create_form = document.forms.post_create_form

    if (post_create_form) {
        const description_input = post_create_form.elements.description
        const photo_input = post_create_form.elements.photo
        const textarea = document.querySelector('.posts__create_post-description textarea')
        const textarea_default_height = getComputedStyle(textarea).height

        post_create_form.onsubmit = e => {
            e.preventDefault()

            const form = new FormData()
            form.append('description', description_input.value)
            form.append('photo', photo_input.files[0])

            const headers = {
                'X-CSRFToken': csrf_token,
                'Content-Type': `multipart/form-data;
                 boundary=${form._boundary}`
            }

            async function _() {
                const url = `{% url 'post:create' %}`
                const response = await axios.post(url, form, {headers})

                const post_wrapper = document.createElement('div')
                post_wrapper.innerHTML = response.data.post

                const error_messages = posts_container.querySelector('.users_error_message')
                error_messages && error_messages.remove()

                const header_width = getComputedStyle(document.querySelector('header')).width
                Array.from(post_wrapper.children).forEach(
                    elem => {
                        posts_container.insertAdjacentElement(
                            'afterbegin',
                            elem,
                        )
                        setPostsElemJS(elem)
                    }
                )
                onPossibleScroll(header_width)

                description_input.value = ''
                photo_input.value = ''
                textarea.style.height = textarea_default_height

                const last_photo = document.querySelector('.posts__create_post-description-new_photo')
                last_photo && last_photo.remove()
            }_()
        }
        textarea.addEventListener("input", () => {
            textarea.style.height = '5px'
            textarea.style.height = textarea.scrollHeight + "px"
        })
    }
</script>