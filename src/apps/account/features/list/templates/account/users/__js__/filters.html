<script defer>
    const users_container = document.querySelector('.users__container')
    const filters_form = document.forms.filters_form

    filters_form.onsubmit = (e) => {
        e.preventDefault()

        const header_width = getComputedStyle(document.querySelector('header')).width

        function get_multi_query_strings(input_set, name) {
            return input_set.filter(checkout => checkout.checked)
                            .map(checkout => `${name}=${checkout.value}`)
                            .join('&')
        }

        const gender_input_set = Array.from(filters_form.gender)
        const age_input_set = Array.from(filters_form.age)

        const gender_set = get_multi_query_strings(gender_input_set, 'gender')
        const age_set = get_multi_query_strings(age_input_set, 'age')

        let data = ''
        if (gender_set && age_set)
            data = `${gender_set}&${age_set}`
        else if (gender_set)
            data = gender_set
        else if (age_set)
            data = age_set

        async function _() {
            const url = `{% url 'account:filter_users' %}`

            // IF CAHN+++

            const response = await axios.get(`${url}?${data}`)

            window.scrollTo(0, 0)

            const users_batch = document.createElement('div')
            users_batch.innerHTML = response.data

            setUsersButtons({
                forms: users_batch.querySelectorAll('.follow_button__form'),
                follow_buttons: users_batch.querySelectorAll('.follow_button__button'),
                usernames: users_batch.querySelectorAll('.user__info-username-link-username'),
            })

            users_container.innerHTML = ''

            const elements = Array.from(users_batch.children)
            elements.forEach(
                elem => users_container.insertAdjacentElement('afterbegin', elem)
            )

            infinityPaginationHandler(`${data}`)
            onPossibleScroll(header_width)

            const cross = document.querySelector('.filters__search-cross')
            cross.hidden = true
        }_()
    }
</script>