<script defer>
    const form = document.querySelector('.follow_button__form')
    const follow_button = document.querySelector('.follow_button__button')
    const url = "{% url 'account:follow' user.username %}"

    form.onsubmit = (e) => {
        e.preventDefault()
        const action = follow_button.innerText

        const form = new FormData()
        form.append('action', action)

        const headers = {
            'X-CSRFToken': csrf_token,
            'Content-Type': `multipart/form-data;
             boundary=${form._boundary}`,
        }
        async function send_post() {
            const response = await axios.post(url, form, {headers})
            const new_action = response.data.action

            follow_button.innerHTML = new_action
            follow_button.style.backgroundColor =
                new_action === 'Follow' ? 'rgb(1, 135, 180)' : 'red'
        }
        send_post()
    }
</script>