<script defer>
    const following_content = document.querySelector('.following__content')
    let FollowingPaginationBlockRequest = false

    function setFollowPagination(
        pagination_items,
        ellipsis_left,
        ellipsis_right,
        next_arrow,
        previous_arrow,
    ) {
        async function loadPage(page) {
            if (!FollowingPaginationBlockRequest) {
                FollowingPaginationBlockRequest = true

                const url = `{% url 'account:follow_pagination' user.username %}`
                const response = await axios.get(
                    `${url}?page=${page}`
                )

                const following_elem = document.createElement('div')
                following_elem.innerHTML = response.data

                setFollowPagination(
                    following_elem.querySelectorAll('.followings__pagination-item'),
                    following_elem.querySelector('.full_left'),
                    following_elem.querySelector('.full_right'),
                    following_elem.querySelector('.next_arrow'),
                    following_elem.querySelector('.previous_arrow'),
                )

                following_content.innerHTML = ''
                following_content.append(following_elem)

                setLazyImages()

                FollowingPaginationBlockRequest = false
            }
        }

        for (let item of pagination_items) {
            item.onclick = function () {
                const page = this.innerHTML
                loadPage(page)
            }
        }
        if (ellipsis_left) ellipsis_left.onclick = () => {
            const page = 1
            loadPage(page)
        }
        if (ellipsis_right) ellipsis_right.onclick = () => {
            const page = Number({{ following_users.paginator.num_pages }})
            loadPage(page)
        }
        if (next_arrow) next_arrow.onclick = () => {
            const page = next_arrow.dataset.next
            loadPage(page)
        }
        if (previous_arrow) previous_arrow.onclick = () => {
            const page = previous_arrow.dataset.previous
            loadPage(page)
        }
    }
    setFollowPagination(
        document.querySelectorAll('.followings__pagination-item'),
        document.querySelector('.full_left'),
        document.querySelector('.full_right'),
        document.querySelector('.next_arrow'),
        document.querySelector('.previous_arrow'),
    )
</script>